To count bigrams we simply take every line in the map stage and start with the first word. If there is another word in the line, then we create a bigram of the first word and the next word. We then set the next word to current word and repeat until no more words are left in the line.
To count file splits, we simply add a key value pair every time cleanup is called since it is called at the end of every task.
The total line splits is 3.